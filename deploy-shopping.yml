version: "3"

services:
  database:
    image: mongo:3
    networks:
      - internal
    
  backend:
    image: sylvanld/shopping-backend
    networks:
      - www
      - internal
    environment:
      SHOPPING_DATABASE_URI: mongodb://database:27017/shopping
    deploy:
      labels:
        traefik.enable: "true"
        traefik.http.routers.shopping-backend.rule: "Host(`api.shopping.sylvan.ovh`)"
        traefik.http.services.shopping-backend.loadbalancer.server.port: "80"
        traefik.docker.network: "www"
        
networks:
  www:
    external: true
  internal:
